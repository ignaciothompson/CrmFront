<!-- Mobile filter button -->
<div class="mobile-filter-button" *ngIf="isMobile" (click)="toggleFilters()">
  <i class="fa fa-filter"></i>
  <span>Filtros</span>
</div>

<!-- Mobile filters overlay -->
<div class="mobile-filters-overlay" *ngIf="isMobile" [class.open]="filtersOpen" (click)="closeFilters()">
  <div class="mobile-filters-container" (click)="$event.stopPropagation()">
    <div class="mobile-filters-header">
      <h4>Filtros</h4>
      <button class="close-button" (click)="closeFilters()">
        <i class="fa fa-times"></i>
      </button>
    </div>
    <div class="mobile-filters-content">
      <div class="mobile-filters">
        <app-filter-sidebar
          [filters]="filterConfigs"
          [filterValues]="filterValues"
          (filterChange)="onFilterChange($event)"
        ></app-filter-sidebar>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-xs-12 col-sm-9">
    <div class="cards-container-3">
      @for (u of items; track u) {
        <div class="card selectable" (click)="toggleSelect(u)" [class.selected]="isSelected(u)">
          <div class="card-image">
            <img [src]="u?.imagenUrl || u?.imagen || u?.image || defaultImg" (error)="onImgError($event)" alt="{{ u?.nombre || u?.name }}" />
            @if (isSelected(u)) {
              <div class="select-badge">Seleccionada</div>
            }
          </div>
          <div class="card-data">
            <div class="card-title">{{ u?.nombre || u?.name }}</div>
            <div class="card-subtitle">{{ u?.barrio || '-' }}, {{ u?.city || u?.localidad }}</div>
            <div class="card-meta">
              <span><b>Precio:</b> {{ u?.precio | currency:'USD' }}</span>
              <span class="m-l-sm"><b>Disponibilidad:</b> {{ (!u?.vendida && !u?.sold) ? 'Disponible' : 'Vendido' }}</span>
            </div>
          </div>
        </div>
      }
    </div>
    @if (selectedCount() >= 2) {
      <div class="compare-floating">
        <button class="btn c-btn btn-small btn-primary" (click)="openCompareModal($event)">Comparar ({{ selectedCount() }})</button>
      </div>
    }
  </div>
  <div class="col-xs-12 col-sm-3" *ngIf="!isMobile">
    <app-filter-sidebar
      [filters]="filterConfigs"
      [filterValues]="filterValues"
      (filterChange)="onFilterChange($event)"
    ></app-filter-sidebar>
  </div>
</div>
